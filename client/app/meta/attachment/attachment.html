<md-dialog id="attach-file-dialog" flex="50" aria-label="Attach files">
	<form ng-cloak>
		<md-dialog-content>
			<div class="md-dialog-content">
				<div class="new-files md-padding">
					<h2 ng-if="!atVm.notebookPreview._id" class="dialog-section-title">Add New Media</h2>
					<h2 ng-if="atVm.notebookPreview._id" class="dialog-section-title">Attached Notebook Media</h2>

					<!--this shows on notebook selection-->
					<div ng-if="atVm.notebookPreview" layout="row" flex layout-align="center center">
						<div flex="50" class="md-padding">
							<img ng-if="atVm.notebookPreview.media.image" ngf-src="atVm.notebookPreview.media.image.path" class="thumb">
						</div>
						<div flex="50" class="md-padding">
							<wave-preview
									ng-if="atVm.notebookPreview.media.audio"
									flex
									url="{{atVm.notebookPreview.media.audio.path}}"
									auto-play="false"
									player-wave-color="white"
									player-cursor-color="#FF5252"
									player-height="100"
									player-progress-color="black">
							</wave-preview>
						</div>
					</div>

					<!--this shows if notebook is not selected-->
					<div ng-if="!atVm.notebookPreview" class="upload-buttons" layout="row" layout-align="space-between center">
						<div flex class="upload-selection">
							<div layout="row" layout-align="center center">
								<md-button ngf-select
								           name="imageUpload"
								           class="md-icon-button"
								           ng-model="atVm.currentFileEditable.media.image"
								           accept="image/*">
									<!--ngf-max-size="5MB"-->
									<!--ngf-validate="{width: {min: 1400, max:2000}, height: {min: 630, max: 900}}"-->
									<md-icon>camera_alt</md-icon>
								</md-button>
							</div>

							<div flex class="md-padding media-container" ng-if="atVm.currentFileEditable.media.image" >
								<md-button ng-if="atVm.currentFileEditable.mediaType !== 'notebook'" class="md-icon-button remove-preview" ng-click="atVm.removeMedia(atVm.currentFileEditable.media.image); atVm.currentFileEditable.media.image = null" >
									<md-icon>cancel</md-icon>
								</md-button>
								<img ng-show="atVm.currentFileEditable.media.image" ngf-src="atVm.imagePath" class="thumb">
							</div>

						</div> <!--this shows if notebook is not selected-->

						<div flex class="upload-selection">
							<div layout="row" layout-align="center center">
								<md-button ngf-select
								           name="audioUpload"
								           class="md-icon-button"
								           ng-model="atVm.currentFileEditable.media.audio"
								           accept="audio/*">
									<md-icon>volume_up</md-icon>
								</md-button>
							</div>
							<div flex class="md-padding media-container" ng-if="atVm.currentFileEditable.media.audio">
								<md-button ng-if="atVm.currentFileEditable.mediaType !== 'notebook'" class="md-icon-button remove-preview" ng-click="atVm.removeMedia(atVm.currentFileEditable.media.audio); atVm.currentFileEditable.media.audio = null" >
									<md-icon>cancel</md-icon>
								</md-button>
								<wave-preview
										ng-if="atVm.currentFileEditable.media.audio"
										flex
										url="{{atVm.audioPath}}"
										auto-play="false"
										player-wave-color="white"
										player-cursor-color="#FF5252"
										player-height="100"
										player-progress-color="black">
								</wave-preview>
							</div>
						</div>
					</div>

				</div>

				<md-divider ng-if="atVm.currentFileEditable.notebookId || atVm.currentFileEditable.mediaType === 'notebook' || !atVm.currentFileEditable.mediaType"></md-divider>

				<!--list of notebooks-->
				<div ng-hide="atVm.currentFileEditable.media.image || atVm.currentFileEditable.media.audio" class="notebook">

					<h2 class="dialog-section-title md-padding">Attach from notebook</h2>
					<md-input-container md-no-float class="md-block" >
						<md-icon class="material-icons">search</md-icon>
						<form ng-submit="atVm.searchSubmit()">
							<input ng-model="atVm.searchText" placeholder="Search Notebooks...">
						</form>
					</md-input-container>

					<md-divider></md-divider>

					<md-content class="search-result-wrapper">
						<md-list>
							<md-list-item
									ng-repeat="notebook in atVm.notebooks | filter: atVm.searchText"
									class="md-2-line notebook-item"
									ng-click="atVm.showNotebookPreview(notebook)"
									md-ink-ripple layout="row"
									layout-align="center center"
									ng-class="{ 'nb-active': notebook == atVm.activeNotebook }">

								<!--<div md-ink-ripple layout="column">-->

								<div class="md-list-item-image sm-padding" flex="15">
									<div class="image-wrapper">
										<img ng-if="notebook.media.image" ng-src="{{notebook.media.image.path}}" alt="">
									</div>
								</div>

								<div class="md-list-item-text sm-padding" flex="55" layout="column">
									<h3>{{notebook.name}}</h3>
									<p>{{notebook.description}}</p>
								</div>
								<div class="md-list-item-audio sm-padding" flex="30" layout="column" layout-align="center center">
									<md-button ng-if="notebook.media.audio" class="md-icon-button">
										<!--ng-click="atVm.playPauseAudio(notebook); $event.stopPropagation()"-->
										<md-icon class="material-icons">volume_up</md-icon>
									</md-button>
								</div>

								<md-divider></md-divider>
							</md-list-item>
						</md-list>
					</md-content>
				</div>

			</div>
		</md-dialog-content>

		<md-divider></md-divider>

		<md-dialog-actions layout="row" layout-align="space-between">
			<md-button ng-click="atVm.cancel('cancel')">
				Cancel
			</md-button>
			<md-button ng-click="atVm.save(atVm.currentFileEditable)">
				Okay
			</md-button>
		</md-dialog-actions>

	</form>
</md-dialog>